# Prompt-Guided Latent Diffusion with Predictive Class Conditioning for 3D Prostate MRI Generation

**Authors:** Emerson P. Grabke, Masoom A. Haider*, Babak Taati*
**arXiv:** [arXiv:2506.10230](https://arxiv.org/abs/2506.10230) 
**PDF:** [Download PDF](https://arxiv.org/pdf/2506.10230.pdf)

*MAH and BT are co-senior authors on this work

Manuscript has been submitted to IEEE for possible publication

## Abstract

> Latent diffusion models (LDM) could alleviate data scarcity challenges affecting machine learning development for medical imaging. However, medical LDM training typically relies on performance- or scientific accessibility-limiting strategies including a reliance on short-prompt text encoders, the reuse of non-medical LDMs, or a requirement for fine-tuning with large data volumes. We propose a **C**lass-**C**onditioned **E**fficient **L**arge **L**anguage model **A**dapter (CCELLA) to address these limitations. CCELLA is a novel dual-head conditioning approach that simultaneously conditions the LDM U-Net with non-medical large language model-encoded text features through cross-attention and with pathology classification through the timestep embedding. We also propose a joint loss function and a data-efficient LDM training framework. In combination, these strategies enable pathology-conditioned LDM training for high-quality medical image synthesis given limited data volume and human data annotation, improving LDM performance and scientific accessibility. Our method achieves a 3D FID score of 0.025 on a size-limited prostate MRI dataset, significantly outperforming a recent foundation model with FID 0.071. When training a classifier for prostate cancer prediction, adding synthetic images generated by our method to the training dataset improves classifier accuracy from 69% to 74%. Training a classifier solely on our method's synthetic images achieved comparable performance to training on real images alone.

## Code availability
Coming soon!
